<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets Test</title>
</head>
<body>

<h2>Google Sheet Auto Fill Test</h2>

<button onclick="handleAuthClick()">Login with Google</button>
<button onclick="writeData()">Write Data</button>

<script>
  const CLIENT_ID = "211687593638-nhqqkfqj53vaiosgd5dm2f3hvhjt0sc0.apps.googleusercontent.com";
  const API_KEY = "AIzaSyA...xreA";

  const SCOPES = "https://www.googleapis.com/auth/spreadsheets";

  function gapiLoaded() {
    gapi.load('client', initializeGapiClient);
  }

  async function initializeGapiClient() {
    await gapi.client.init({
      apiKey: API_KEY,
      discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
    });
  }

  function gisLoaded() {
    tokenClient = google.accounts.oauth2.initTokenClient({
      client_id: CLIENT_ID,
      scope: SCOPES,
      callback: "",
    });
  }

  function handleAuthClick() {
    tokenClient.callback = (resp) => {
      console.log("Logged in!");
    };

    tokenClient.requestAccessToken();
  }

  async function writeData() {
    const sheetId = "YOUR_SPREADSHEET_ID"; 
    const range = "Sheet1!A1";
    const values = [["Hello from GitHub Website!"]];

    const response = await gapi.client.sheets.spreadsheets.values.update({
      spreadsheetId: sheetId,
      range: range,
      valueInputOption: "RAW",
      resource: { values: values },
    });

    alert("Data Written!");
  }
</script>

<script src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
<script src="https://accounts.google.com/gsi/client" onload="gisLoaded()" async defer></script>

</body>
</html>
